#define B_table_num 91

typedef struct _ADC_to_Vol{
    int adc;
    float vol;
}ADC_to_Vol;

ADC_to_Vol BPlus_adc_table[B_table_num] = {
    {669,	7},
    {684,	7.1},
    {693,	7.2},
    {701,	7.3},
    {713,	7.4},
    {721,	7.5},
    {731,	7.6},
    {741,	7.7},
    {751,	7.8},
    {763,	7.9},
    {772,	8},
    {783,	8.1},
    {792,	8.2},
    {804,	8.3},
    {816,	8.4},
    {824,	8.5},
    {835,	8.6},
    {845,	8.7},
    {855,	8.8},
    {867,	8.9},
    {878,	9},
    {887,	9.1},
    {897,	9.2},
    {908,	9.3},
    {918,	9.4},
    {928,	9.5},
    {940,	9.6},
    {947,	9.7},
    {962,	9.8},
    {969,	9.9},
    {981,	10},
    {991,	10.1},
    {999,	10.2},
    {1011,	10.3},
    {1022,	10.4},
    {1031,	10.5},
    {1042,	10.6},
    {1054,	10.7},
    {1065,	10.8},
    {1072,	10.9},
    {1083,	11},
    {1094,	11.1},
    {1104,	11.2},
    {1117,	11.3},
    {1125,	11.4},
    {1137,	11.5},
    {1148,	11.6},
    {1156,	11.7},
    {1165,	11.8},
    {1177,	11.9},
    {1188,	12},
    {1197,	12.1},
    {1207,	12.2},
    {1218,	12.3},
    {1227,	12.4},
    {1239,	12.5},
    {1248,	12.6},
    {1260,	12.7},
    {1270,	12.8},
    {1281,	12.9},
    {1290,	13},
    {1302,	13.1},
    {1311,	13.2},
    {1322,	13.3},
    {1334,	13.4},
    {1342,	13.5},
    {1354,	13.6},
    {1361,	13.7},
    {1373,	13.8},
    {1382,	13.9},
    {1394,	14},
    {1405,	14.1},
    {1414,	14.2},
    {1426,	14.3},
    {1434,	14.4},
    {1447,	14.5},
    {1454,	14.6},
    {1464,	14.7},
    {1476,	14.8},
    {1491,	14.9},
    {1499,	15},
    {1507,	15.1},
    {1514,	15.2},
    {1527,	15.3},
    {1537,	15.4},
    {1548,	15.5},
    {1559,	15.6},
    {1569,	15.7},
    {1579,	15.8},
    {1591,	15.9},
    {1598,	16}
};

float BPlus_Voltage(int adc){
    int l = 0;
    int r = sizeof(BPlus_adc_table)/sizeof(BPlus_adc_table[0]) - 1;
    int protect = 0;
    int m = 0;

    if(adc < 669) return -1;
    if(adc > 1598) return -1;

    while(l <= r){
        protect++;
        m = l + (r-l)/2;

        if(adc == BPlus_adc_table[l].adc){
            return BPlus_adc_table[l].vol;
        }
        if(adc == BPlus_adc_table[r].adc){
            return BPlus_adc_table[r].vol;
        }

        if(BPlus_adc_table[m].adc == adc){
            return BPlus_adc_table[m].vol;
        }
        else if((r-l) <= 1){
            return BPlus_adc_table[l].vol;
        }
        else if(BPlus_adc_table[m].adc > adc){
            r = m;
        }
        else if (BPlus_adc_table[m].adc < adc){
            l = m;
        }
        if(protect>=10) break;
    }
    return -1;
}
